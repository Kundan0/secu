import numpy as np
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt
FPS=25
#depth=[2.5815422534942627, 2.651683807373047, 2.6481335163116455, 2.726611614227295, 2.7940618991851807, 2.5857908725738525, 2.707275867462158, 2.6707069873809814, 2.5966665744781494, 2.6816210746765137, 2.591325044631958, 2.682180881500244, 2.53825306892395, 2.348693609237671, 2.7139782905578613, 2.649087429046631, 2.832368850708008, 2.8351259231567383, 2.756453514099121, 2.829033136367798, 2.7769935131073, 2.652317523956299, 2.7090680599212646, 2.769469738006592, 2.8726069927215576, 2.9354007244110107, 3.0338454246520996, 2.8127551078796387, 2.9507761001586914, 2.9356846809387207, 2.9662463665008545, 2.9584741592407227, 2.6666195392608643, 2.7187447547912598, 2.7005810737609863, 2.6771621704101562, 2.696370840072632, 2.712980270385742, 2.7036924362182617, 2.612264394760132, 2.5622596740722656, 2.665167808532715, 2.6416847705841064, 2.639181613922119, 2.5921201705932617, 2.6980109214782715, 2.5867297649383545, 2.6781725883483887, 2.7082138061523438, 2.4639177322387695, 2.5613901615142822, 2.6353063583374023, 2.851005792617798, 2.7067184448242188, 2.7549641132354736, 2.8044886589050293, 2.7403554916381836, 2.676189661026001, 2.5414249897003174, 2.525005578994751, 2.5198919773101807, 2.514904499053955, 2.4984679222106934, 2.5469958782196045, 2.6863784790039062, 2.821223497390747, 2.7956817150115967, 2.6789543628692627, 2.6404600143432617, 2.7078983783721924, 2.7695698738098145, 2.716622829437256, 2.647895574569702, 2.7594475746154785, 2.644843339920044, 2.6772267818450928, 2.8617005348205566, 2.7039997577667236, 2.7652554512023926, 2.4301159381866455, 2.374868154525757, 2.3999531269073486, 2.536442756652832, 2.5075020790100098, 2.348081350326538, 2.564002752304077, 2.457592248916626, 2.4289259910583496, 2.4933950901031494, 2.245089530944824, 2.1520297527313232, 2.335686206817627, 2.273622751235962, 2.629220962524414, 2.651613235473633, 2.6277999877929688, 2.780341148376465, 2.681663990020752, 2.6798017024993896, 2.6675007343292236, 2.6798582077026367, 2.5712056159973145, 2.777101993560791, 2.6212735176086426, 2.7171988487243652, 2.5971527099609375, 2.816409111022949, 2.6806933879852295, 2.5616891384124756, 2.7901253700256348, 2.900766134262085, 2.822861909866333, 2.851572275161743, 2.8170127868652344, 2.6942672729492188, 2.725609302520752, 2.691931962966919, 2.5801138877868652, 2.6473710536956787, 2.4727461338043213, 2.6148102283477783, 2.5573573112487793, 2.613440990447998, 2.592491865158081, 2.6548871994018555, 2.6146464347839355, 2.59956693649292, 2.534799814224243, 2.4281764030456543, 2.5549557209014893, 2.384084701538086, 2.6270527839660645, 2.6413497924804688, 2.5519180297851562, 2.309014320373535, 2.2870850563049316, 2.6293373107910156, 2.50049090385437, 2.4134433269500732, 2.4180827140808105, 2.491058349609375, 2.5440754890441895, 2.559283494949341, 2.5757548809051514, 2.73993182182312, 2.5520870685577393, 2.484708786010742, 2.567150831222534, 2.5808844566345215, 2.508220672607422, 2.688072919845581, 2.6521401405334473, 2.7294416427612305, 2.782923936843872, 2.7280590534210205, 2.5829238891601562, 2.582953929901123, 2.5117087364196777, 2.2302486896514893, 2.23211932182312, 2.522449016571045, 2.5457890033721924, 2.419799566268921, 2.249204158782959, 2.203207492828369, 2.1972153186798096, 2.270055055618286, 2.288769245147705, 2.2913966178894043, 2.230875015258789, 2.2057735919952393, 2.1496999263763428, 2.386827230453491, 2.2432308197021484, 2.080690383911133, 2.1072304248809814, 2.1465566158294678, 2.360053777694702, 2.2730510234832764, 2.2662863731384277, 2.500988721847534, 2.4746227264404297, 2.236708879470825, 2.2844817638397217, 2.3125267028808594, 2.2755959033966064, 2.274785041809082, 2.3124172687530518, 2.2862625122070312, 2.3614399433135986]
depth=[2.5822603702545166, 2.6505396366119385, 2.6475138664245605, 2.725313425064087, 2.7958409786224365, 2.5837466716766357, 2.70674991607666, 2.670541286468506, 2.5942420959472656, 2.680743932723999, 2.5900001525878906, 2.6851565837860107, 2.5386221408843994, 2.3504886627197266, 2.7136409282684326, 2.6499946117401123, 2.835487127304077, 2.8322389125823975, 2.758472442626953, 2.827652931213379, 2.776609182357788, 2.6500003337860107, 2.709521770477295, 2.7690751552581787, 2.8695640563964844, 2.936307668685913, 3.033590793609619, 2.8128302097320557, 2.9535021781921387, 2.9346511363983154, 2.96781587600708, 2.9572947025299072, 2.663827896118164, 2.7154102325439453, 2.699134111404419, 2.67873477935791, 2.6998579502105713, 2.714416980743408, 2.703742742538452, 2.6122889518737793, 2.563816547393799, 2.663088798522949, 2.642798900604248, 2.641386032104492, 2.592376232147217, 2.6978201866149902, 2.5798213481903076, 2.679335355758667, 2.7119433879852295, 2.463898181915283, 2.5633881092071533, 2.6353647708892822, 2.8515920639038086, 2.707961082458496, 2.7548482418060303, 2.8076226711273193, 2.7388577461242676, 2.676579713821411, 2.543816566467285, 2.5241198539733887, 2.5169308185577393, 2.5150341987609863, 2.4993221759796143, 2.5464677810668945, 2.687901020050049, 2.821866512298584, 2.797098159790039, 2.6806347370147705, 2.6392223834991455, 2.7076563835144043, 2.77056884765625, 2.7150168418884277, 2.6464040279388428, 2.7624433040618896, 2.6451053619384766, 2.6736886501312256, 2.857874631881714, 2.705322504043579, 2.7640740871429443, 2.427568197250366, 2.374422311782837, 2.4000325202941895, 2.5364739894866943, 2.506105422973633, 2.3472394943237305, 2.5654094219207764, 2.4586286544799805, 2.4276819229125977, 2.4943394660949707, 2.2441272735595703, 2.1499855518341064, 2.3354296684265137, 2.27313494682312, 2.6288700103759766, 2.6506614685058594, 2.6283650398254395, 2.7816286087036133, 2.682799816131592, 2.6811015605926514, 2.669323444366455, 2.683924674987793, 2.572348117828369, 2.775582790374756, 2.6216063499450684, 2.714425563812256, 2.599776268005371, 2.818725347518921, 2.6783642768859863, 2.5603854656219482, 2.789483070373535, 2.8999123573303223, 2.8197810649871826, 2.8502535820007324, 2.8151557445526123, 2.693284034729004, 2.724825143814087, 2.6908891201019287, 2.580153703689575, 2.6462833881378174, 2.4706153869628906, 2.6156623363494873, 2.5533483028411865, 2.613584518432617, 2.589916706085205, 2.6559174060821533, 2.61189866065979, 2.598391532897949, 2.532869577407837, 2.4262003898620605, 2.5539469718933105, 2.3863792419433594, 2.625365972518921, 2.6388049125671387, 2.554076910018921, 2.310279130935669, 2.2850422859191895, 2.6290042400360107, 2.500398874282837, 2.413170576095581, 2.418541431427002, 2.4916152954101562, 2.5416011810302734, 2.5586652755737305, 2.5763051509857178, 2.7387592792510986, 2.5505101680755615, 2.4858131408691406, 2.5675392150878906, 2.578336715698242, 2.5067527294158936, 2.6865298748016357, 2.6555798053741455, 2.730504035949707, 2.780993938446045, 2.7278709411621094, 2.581923246383667, 2.5845959186553955, 2.5026373863220215, 2.232760190963745, 2.2323076725006104, 2.5226619243621826, 2.5470542907714844, 2.4215762615203857, 2.250509023666382, 2.202366352081299, 2.197957992553711, 2.2680320739746094, 2.285085439682007, 2.292584180831909, 2.231621026992798, 2.2050294876098633, 2.149853229522705, 2.3869059085845947, 2.242851972579956, 2.0825018882751465, 2.110377073287964, 2.1474549770355225, 2.3580002784729004, 2.273564100265503, 2.268134355545044, 2.4988772869110107, 2.474733829498291, 2.2354941368103027, 2.2832720279693604, 2.3118743896484375, 2.2728841304779053, 2.2759616374969482, 2.3118491172790527, 2.2864644527435303, 2.357567071914673]

depths=[depth[38*i:38*(i+1)] for i in range(int(len(depth)/38))]
x=np.arange(38).reshape(-1,1)
print("\n\n STARTING THE PROGRAM \n\n\n")
for i in range(len(depths)):
    i=0
    depth_bucket=np.array(depths[i])
    print(depth_bucket)
    lr=LinearRegression()
    model=lr.fit(x,depth_bucket)
    depth_end=list(model.predict(np.array([0,37]).reshape(-1,1)))
    depth_line=list(model.predict(np.array([i for i in range(38)]).reshape(-1,1)))
    
    print(depth_end)
    delta_depth=(depth_end[1]-depth_end[0])
    avg_depth=(depth_end[1]+depth_end[0])/2
    vel_x=delta_depth*FPS/2
    print(vel_x)
    fig = plt.figure()
    ax1 = fig.add_subplot(111)
    ax1.scatter(x.reshape(-1,1),depth_bucket,c='b')
    ax1.scatter(x.reshape(-1,1),depth_line,c='r')
    plt.show()
    print("\n\n\n\n")
    break

#vel_y=((tracks[i][0][0]-tracks[i][37][0])+(tracks[i][0][2]-tracks[i][37][2]))*FPS/2560
#each_item["velocity"].append((vel_x,vel_y))